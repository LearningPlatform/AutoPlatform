<!-- 全局变量 -->
<div ng-controller="ProVarCtrl">
    <div>
        <h1 class="page-header text-primary">全局变量</h1>
        <div>
            <div class="alert alert-info" ng-show="varInfoShow">
                项目级别的变量可用于在本项目中API测试
                <button class="btn bg-info pull-right" ng-click="varInfoShow = !varInfoShow"><span class="glyphicon glyphicon-remove"></span></button>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-body">
                <div>
                    <ul class="nav nav-tabs">
                        <li class="{$evnactive$}">
                            <a ng-click="showEvnDiv()">环境列表</a></li>
                        <li class="{$varactive$}">
                            <a ng-click="showVarDiv()">变量列表</a></li>
                    </ul>
                </div>
                <div class="panel-body">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default" ng-click="addEnv()">
                                        新增环境
                                    </button>
                                    <button type="button" class="btn btn-default" ng-click="addVar()">
                                        新增变量
                                    </button>
                                </div>
                            </div>
                            <form>
                                <div class="col-md-3 col-md-offset-4">
                                    <input class="form-control">
                                </div>
                                <div class="col-md-1">
                                    <button class="form-control">查询</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="panel-body" ng-show="'evn'==showDivType">
                        <div ng-repeat="env in envList">
                            <div class="panel panel-success"  ng-mouseenter="showBtn(env.id)" ng-mouseleave="hideBtn(env.id)">
                                <div class="panel-heading">
                                    <h4 class="panel-title" ng-click="getEnvVar(env.id)">
                                        <a ng-click="getEnvVar(env.id)" ng-bind="env.env_name"></a>
                                        <div class="col-md-4 pull-right"  ng-show="env.id==showID&&showHo">
                                            <a class="op" ng-click="delEnvCom(env.id)"><span class="glyphicon glyphicon-remove"></span>删除</a>
                                            <a class="op" ng-click="editEnvCom(env.id)"><span class="glyphicon glyphicon-pencil"></span>编辑</a>
                                        </div>
                                    </h4>
                                </div>
                                <div class="panel-body" ng-show="(env.id==showtableid)&&showtable">
                                    <table class="table table-hover table-bordered">
                                        <thead>
                                        <th> 变量名</th>
                                        <th> 类型</th>
                                        <th> 变量值</th>
                                        <th> 描述</th>
                                        <th> 操作</th>
                                        </thead>
                                        <tbody ng-repeat="envvar in envVarList">
                                        <tr>
                                            <td ng-bind="envvar.var_name"></td>
                                            <td ng-bind="envvar.var_type"></td>
                                            <td ng-bind="envvar.var_value"></td>
                                            <td ng-bind="envvar.var_desc"></td>
                                            <td >
                                                <a><span class="glyphicon glyphicon-remove" ng-click="delVarCom(envvar.env_id,envvar.var_id)">删除</span></a>
                                                <a><span class="glyphicon glyphicon-edit">编辑</span></a>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body" ng-show="'var'==showDivType">
                        <div ng-repeat="var in varList">
                            <div class="panel panel-success" ng-mouseenter="showBtn(var.var_id)" ng-mouseleave="hideBtn(var.var_id)">
                                <div class="panel-heading">
                                    <h4 class="panel-title" ng-click="getVarEnv(var.var_id)" >
                                        <a ng-bind="var.var_name"></a>
                                        <div class="col-md-4 pull-right"  ng-show="var.var_id==showID&&showHo">
                                            <a class="op" ng-click="delVarCom(var.var_id)"><span class="glyphicon glyphicon-remove"></span>删除</a>
                                            <a class="op" ng-click="editVarCom(var.var_id)"><span class="glyphicon glyphicon-pencil"></span>编辑</a>
                                        </div>
                                    </h4>
                                </div>
                                <div class="panel-body" ng-show="(var.var_id==showtableid2)&&showtable2">
                                    <table class="table table-hover table-bordered" >
                                        <thead>
                                        <th> 环境</th>
                                        <th> 类型</th>
                                        <th> 变量值</th>
                                        <th> 描述</th>
                                        <th> 操作</th>
                                        </thead>
                                        <tbody>
                                        <tr  ng-repeat="varEnv in varEnvList.var_value">
                                            <td ng-bind="varEnv.env_name"></td>
                                            <td ng-bind="var.var_type"></td>
                                            <td ng-bind="varEnv.var_env_value"></td>
                                            <td ng-bind="var.var_desc"></td>
                                            <td>
                                                <a><span class="glyphicon glyphicon-remove" ng-click="delEnvCom(varEnv.env_id,var.var_id)">删除</span></a>
                                                <a><span class="glyphicon glyphicon-edit">编辑</span></a>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="envAddModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        添加环境
                    </h4>
                </div>
                <div class="modal-body" id="myModal">
                    <div id="addapi">
                        <form role="form" method="post" enctype="multipart/form-data" class="form-horizontal">
                            <label for="suite_name" class="col-md-2 control-label ">环境名</label>
                            <div class="col-md-10">
                                <input type="text" class="form-control" id="suite_name" placeholder="请输入名称" ng-model="env.env_name">
                            </div>
                            <label for="suite_desc" class="col-md-2 control-label">环境描述</label>
                            <div class="col-md-10">
                                <textarea rows="3"class="form-control" id="suite_desc" placeholder="请输入描述" ng-model="env.env_desc"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" ng-click="saveEnv()">保存</button>
                </div>
            </div>
        </div>
    </div>
    <!--添加变量摸态框-->
    <div class="modal fade" id="varAddModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        添加全局变量
                    </h4>
                </div>
                <div class="modal-body" id="myModal">
                    <div id="addapi">
                        <form role="form" method="post" enctype="multipart/form-data" class="form-horizontal">
                            <label for="var_name" class="col-md-2 control-label ">变量名</label>
                            <div class="col-md-10">
                                <input type="text" class="form-control" id="var_name" placeholder="请输入名称" ng-model="var.currVarName">
                            </div>
                            <label for="var_type" class="col-md-2 control-label">类型</label>
                            <div class="col-md-10">
                                <select class="form-control" ng-model="var.currVarType" ng-options="type for type in varType">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                            <label for="var_type" class="col-md-2 control-label">变量值</label>
                            <div class="col-md-10">
                                <div class="panel panel-info">
                                    <div class="panel-body">
                                        <div ng-repeat="env in envList">
                                            <label class="col-md-3 control-label" ng-bind="env.env_name"></label>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" placeholder="请输入变量值" ng-model="var.currVarValue[$index].value">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <label for="var_desc" class="col-md-2 control-label">描述</label>
                            <div class="col-md-10">
                                <textarea rows="3"class="form-control" id="var_desc" placeholder="请输入描述" ng-model="var.currVarDesc"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" ng-click="saveVar()">保存</button>
                </div>
            </div>
        </div>
    </div>
    <!-- 添加项目模态框 -->
    <div  class="modal fade" id="delVarModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        确认
                    </h4>
                </div>
                <div class="modal-body" id="myModal">
                    <div class="modal-body-div">
                        <p>在各个环境下的改变量均会被删除，请确认是否删除？？</p>
                    </div>
                </div>
                <div class="modal-footer btn_div">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-danger" ng-click="delVar()">删除</button>
                </div>
            </div>
        </div>
    </div>
    <!-- 添加项目模态框 -->
    <div  class="modal fade" id="delEnvModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close"
                            data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        确认
                    </h4>
                </div>
                <div class="modal-body" id="myModal">
                    <div class="modal-body-div">
                        <p>该环境下的变量均会被删除，请确认是否删除？？</p>
                    </div>
                </div>
                <div class="modal-footer btn_div">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-danger" ng-click="delEnv()">删除</button>
                </div>
            </div>
        </div>
    </div>
</div>