<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
        {% load staticfiles %}
    <link href="{% static 'styles/library/bootstrap.min.css' %}" rel="stylesheet">
    <script src="{% static 'scripts/library/jquery-3.1.0.min.js' %}"></script>

    <script>
        var txt;
        function addPro(){
            $.get("pro_list",function(data,status){
                txt=data.data;
                for(var i=0;i<txt.length;i++) {
                    $("#main").append(('<div class="col-md-4"><div class="thumbnail"><div class="caption">'+
                                    '<h3>'+txt[i].pro_name+'</h3><p>'+txt[i].pro_desc+'</p>'+
                                    '<a href="../test1.html" class="btn btn-default" role="button">进入项目 </a>'+
                                    '<btn id="edit" class="btn" onclick="edit('+txt[i].id+')">编辑</btn>'+
                                    '<btn class="btn" onclick="del('+txt[i].id+')">删除</btn>'+
                                    '</div></div></div>'));
                };
            })
        }

        function edit(num){
            $('#editModal').modal();
            var canshu={
                pro_id:num
            };
            var o=JSON.stringify(canshu);
            $.post("pro_get/", o, function (data, status) {
                txt = data.data;
                $("#name1").val(txt.pro_name);
                $("#description1").val(txt.pro_desc);
            });
            $("#save1").click(function () {
                var name = $("#name1").val();
                var desc = $("#description1").val();
                var body={
                    type:2,
                    pro_id:num,
                    pro_name:name,
                    pro_desc:desc
                };
                var obj=JSON.stringify(body);
                $.post("pro_save/",obj);
                $("#main").empty();
                addPro();
                $('#editModal').modal('hide');
            })
        }

        function del(i){
            $('#delMol').modal();
            $("#delete").click(function(){
                var id={pro_id:i};
                var ob=JSON.stringify(id);
                $.post("pro_del/", ob);
                $('#delMol').modal('hide');
                $("#main").empty();
                addPro();
            })
        }

        $(document).ready(function() {
            addPro();

            $("#pro").click(function(){
                $('#myModal').modal();
                $("#name").val("");
                $("#description").val("");
            })

            $("#save").click(function () {
                $("#main").empty();
                var name = $("#name").val();
                var desc = $("#description").val();
                var body={
                    type:1,
                    pro_name:name,
                    pro_desc:desc
                };
                var obj=JSON.stringify(body);
                $.post("pro_save/",obj);
                addPro();
                $('#myModal').modal('hide');
            })
        })
    </script>
</head>
<body>
<div>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="#" >自动化平台</a>
            </div>
            <div>
                <form class="navbar-form navbar-right" role="search">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Email">
                        <input type="text" class="form-control" placeholder="Password">
                        <button type="submit" class="btn btn-success">登录</button>
                    </div>
                </form>
            </div>
        </div>
    </nav>
    <div class="collapse navbar-collapse bs-js-navbar-scrollspy">
        <div class="jumbotron">
            <div class="container" style="padding-top: 45px;">
                <h1>接口自动化平台</h1>
                <p>--------------------------------------------------------</p>
                <a class="btn btn-primary btn-lg" id="pro">
                  <span class="glyphicon glyphicon-plus">   </span> 添加项目
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-12 column">
        <div class="container">
            <div  id="main" class="row">
            </div>
        </div>
    </div>

     <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        添加项目
                    </h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">项目名：</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="name"
                                       placeholder="请输入名称">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">描述：</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="description"
                                       placeholder="请输入描述">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                    </button>
                    <button type="button" class="btn btn-primary" id="save" >
                        保存
                    </button>
                </div>
            </div>
        </div>
     </div>

    <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        编辑项目
                    </h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">项目名：</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="name1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">描述：</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="description1">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                    </button>
                    <button type="button" class="btn btn-primary" id="save1" >
                        保存
                    </button>
                </div>
            </div>
        </div>
     </div>



    <div class="modal fade" id="delMol" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">确认</h4>
                </div>
                <div class="modal-body">请确认是否删除？？</div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-danger" id="delete" >删除</button>
                </div>
            </div>
        </div>
    </div>

</div>
</body>
{% load staticfiles %}
<script src="{% static 'scripts/library/jquery-3.1.0.min.js' %}"></script>
<script src="{% static 'scripts/library/bootstrap/bootstrap.min.js' %}"></script>
</html>